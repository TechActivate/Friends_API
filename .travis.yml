sudo: required
services:
  - docker

before_install:
  - docker pull openjdk:11-jdk
  - docker pull maven:3-jdk-11
  - docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"

install:
  - docker build -t techactivate/friendsapi .

script:
  - docker images
  - docker tag techactivate/friendsapi techactivate/friendsapi:$(git rev-parse HEAD)
  - docker push  techactivate/friendsapi:$(git rev-parse HEAD)

deploy:
  provider: heroku
  api_key:
    secure:
      xxx
  on: heroku_production
  app: friendsApi
